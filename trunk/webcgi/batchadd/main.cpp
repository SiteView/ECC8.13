////////////////////////////////////////////////////////////////////////////////////////////////////////////
#ifdef WIN32
#include <windows.h>
#endif
////////////////////////////////////////////////////////////////////////////////////////////////////////////
#include <string>
using namespace std;

////////////////////////////////////////////////////////////////////////////////////////////////////////////
#include "../../opens/libwt/WApplication"
#include "../../opens/libwt/WebSession.h"

#include "batchaddform.h"
////////////////////////////////////////////////////////////////////////////////////////////////////////////

typedef void(*func)(int, char**);
////////////////////////////////////////////////////////////////////////////////////////////////////////////
void PrintDebugString(const char * szMsg);
////////////////////////////////////////////////////////////////////////////////////////////////////////////
void PrintDebugString(const string szMsg)
{
    PrintDebugString(szMsg.c_str());
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////
void PrintDebugString(const char* szMsg)
{
#ifdef WIN32
    OutputDebugString(szMsg);
    OutputDebugString("\n");
#endif
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////
void showForm(int argc, char* argv[])
{
    WApplication app(argc, argv);
    app.setTitle("batch add monitor");
    CSVBatchAdd batchAdd(app.root());
    app.exec();
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////
int main(int argc, char* argv[])
{
    func pfunc = showForm;
    if (argc == 1) 
    {
        //srand((unsigned)time( NULL ));
        int rand1 = rand();
        char buf[256];
        itoa(rand1, buf, 10);
        WebSession s(buf, false);
        s.start(pfunc);
        return 1;
    }
    else
    {
        FCGI_Accept();
        WebSession s("DEBUG", true);
        s.start(pfunc);
        return 1;
    }
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////
// end
