#include "ecctable.h"

#include "../../opens/libwt/WText"
#include "../../opens/libwt/WImage"
#include "../../opens/libwt/WTableCell"
#include "../../opens/libwt/WScrollArea"

/////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 构造函数
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
CEccBaseTable::CEccBaseTable(WContainerWidget *parent):
WTable(parent),
m_pTitle(NULL),
m_pContent(NULL),
m_pOperate(NULL)
{
    m_bShowHelp = false;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 显示帮助
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
void CEccBaseTable::ShowHideHelp()
{
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 初始化
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
void CEccBaseTable::initForm(bool bHasHelp)
{
    // 创建标题
    createTitle(bHasHelp);
    // 创建内容
    createContent();
    // 创建操作
    createOperate();
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 创建标题
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
void CEccBaseTable::createTitle(bool bHasHelp)
{
    int nRow = numRows();
    // 标题表
    WTable *pTitle = new WTable(elementAt(nRow, 0));
    if(pTitle)
    {
        pTitle->setStyleClass("padding_2");
    
        m_pTitle = new WText("Title", pTitle->elementAt(0, 0));
        if(m_pTitle)
            m_pTitle->setStyleClass("textbold");

        // 是否创建帮助
        if(bHasHelp)
        {
            // 创建帮助
            // 2007.1.23 Kevin Yang
            // 将help.gif修改为help.png
            WImage *pHelp = new WImage("../Images/help.png", pTitle->elementAt(0, 1));
            pTitle->elementAt(0, 1)->setContentAlignment(AlignRight);
            if(pHelp)
            {
                pHelp->setStyleClass("hand");
                WObject::connect(pHelp, SIGNAL(clicked()), this, SLOT(ShowHideHelp()));
            }
        }
    }
    elementAt(nRow, 0)->setStyleClass("padding_top");
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 创建操作
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
void CEccBaseTable::createOperate()
{
    int nRow = numRows();
    m_pOperate = new WTable(elementAt(nRow, 0));
    if(m_pOperate)
        m_pOperate->setStyleClass("widthauto");

    elementAt(nRow, 0)->setStyleClass("padding_2");
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 创建内容表
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
void CEccBaseTable::createContent()
{
    m_nContentRow = numRows();
    WTable *pSub = new WTable(elementAt(m_nContentRow, 0));

    if(pSub)
    {
        pSub->setStyleClass("panel");
        WScrollArea *pScroll = new WScrollArea(elementAt(m_nContentRow, 0));
        if(pScroll)
        {
            pScroll->setWidget(pSub);
            pScroll->setStyleClass("panel");
        }

        m_pContent = new WTable(pSub->elementAt(0, 0));
        pSub->elementAt(0, 0)->setContentAlignment(AlignTop);
    }
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 设置标题文本
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
void CEccBaseTable::setTitle(string szTitle)
{
    if(m_pTitle)
        m_pTitle->setText(szTitle);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
void CEccBaseTable::AddHelpText(WText *pHelp)
{
    if(pHelp)
        m_lsHelp.push_back(pHelp);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
void CEccBaseTable::setContentCellStyle(string szStyle)
{
    elementAt(m_nContentRow, 0)->setStyleClass(szStyle);
}

