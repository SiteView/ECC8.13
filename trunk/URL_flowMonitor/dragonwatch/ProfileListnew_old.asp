<!-- #include file="inc/clearcookie.asp" -->
<html>
<head>
<title>预定义文件</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<script language=javascript>
function OpenDownloadWindow(){
childWindow=window.open('/dnchart/download.html','下载java组件','toolbar=FALSE,resizable=1,scrollbars=2,height=400,width=400,screenx=500,screeny=500')

}
function ChkLogin() {
	var user=document.frmLogin.Username.value;
	var pwd =document.frmLogin.Password.value;
	if(user.length<3) {
		alert("用户名长度不应小于3个字符!");
		document.frmLogin.Username.focus();
		return false;
		}
	else {
		if(pwd.length<3) {
			alert("密码长度不应小于3个字符!");
			document.frmLogin.Password.focus();
			return false;
			}
		}
	return true;
}
</script>
<script language="JavaScript1.2">
<!--
function fwLoadMenus() {
  if (window.fw_menu_0) return;
  window.fw_menu_0 = new Menu("root",143,21,"Georgia, Times New Roman, Times, serif",14,"#ffffff","#000000","#000000","#ffffff");
  fw_menu_0.addMenuItem("服务介绍","location='http://www.speed.net.cn/fuwujieshao.htm'");
  fw_menu_0.addMenuItem("监测城市","location='http://www.speed.net.cn/jiancechengshi.htm'");
  fw_menu_0.addMenuItem("销售","location='http://www.speed.net.cn/xiaoshou.htm'");
  fw_menu_0.addMenuItem("演示","location='http://www.speed.net.cn/demos.htm'");
  fw_menu_0.addMenuItem("常见服务问题解答","location='http://www.speed.net.cn/changjianfuwuwentijieda.htm'");
   fw_menu_0.bgImageUp="fwmenu4_143x21_up.gif";
   fw_menu_0.bgImageOver="fwmenu4_143x21_over.gif";
   fw_menu_0.hideOnMouseOut=true;
  window.fw_menu_1 = new Menu("root",143,21,"Georgia, Times New Roman, Times, serif",14,"#ffffff","#000000","#000000","#ffffff");
  fw_menu_1.addMenuItem("技术概况","location='http://www.speed.net.cn/jishugaikuang.htm'");
  fw_menu_1.addMenuItem("监测系统分布","location='http://www.speed.net.cn/jiancexitongfenbu.htm'");
  fw_menu_1.addMenuItem("如何使用客户界面","location='http://www.speed.net.cn/yonghujiemian.htm'");
  fw_menu_1.addMenuItem("常见技术问题解答","location='http://www.speed.net.cn/changjianjishuwentijieda.htm'");
  fw_menu_1.addMenuItem("联络技术支持","location='http://www.speed.net.cn/lianluojishuzhichi.htm'");
   fw_menu_1.bgImageUp="fwmenu3_143x21_up.gif";
   fw_menu_1.bgImageOver="fwmenu3_143x21_over.gif";
   fw_menu_1.hideOnMouseOut=true;
  window.fw_menu_2 = new Menu("root",87,21,"Georgia, Times New Roman, Times, serif",14,"#ffffff","#000000","#000000","#ffffff");
  fw_menu_2.addMenuItem("公司介绍","location='http://www.speed.net.cn/company.htm'");
  fw_menu_2.addMenuItem("合作机会","location='http://www.speed.net.cn/hezuojihui.htm'");
  fw_menu_2.addMenuItem("工作机会","location='http://www.speed.net.cn/gongzuojihui.htm'");
  fw_menu_2.addMenuItem("联络方式","location='http://www.speed.net.cn/lianluofangshi.htm'");
   fw_menu_2.bgImageUp="fwmenu2_87x21_up.gif";
   fw_menu_2.bgImageOver="fwmenu2_87x21_over.gif";
   fw_menu_2.hideOnMouseOut=true;
  window.fw_menu_3 = new Menu("root",115,21,"Georgia, Times New Roman, Times, serif",14,"#ffffff","#000000","#000000","#ffffff");
  fw_menu_3.addMenuItem("专用词汇注解","location='http://www.speed.net.cn/zhuanyongzihuizhujie.htm'");
   fw_menu_3.bgImageUp="fwmenu1_115x21_up.gif";
   fw_menu_3.bgImageOver="fwmenu1_115x21_over.gif";
   fw_menu_3.hideOnMouseOut=true;

  fw_menu_3.writeMenus();
} // fwLoadMenus()

//-->
</script>
<script language="JavaScript1.2" src="inc/fw_menu.js"></script>
<link rel="stylesheet" href="profile.css" type="text/css">
</head>
<body topmargin="0" leftmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff" text="#000000" link="#FFFFFF" vlink="#FFFFFF" alink="#FFFFFF">
<script language="JavaScript1.2">fwLoadMenus();</script>
<table border="0" cellpadding="0" cellspacing="0" width="755">
  <!-- fwtable fwsrc="Untitled-2.png" fwbase="Untitled-2.gif" fwstyle="Dreamweaver" fwdocid = "742308039" fwnested="0" -->
  <tr> 
    <td><img src="spacer.gif" width="182" height="1" border="0"></td>
    <td><img src="spacer.gif" width="237" height="1" border="0"></td>
    <td><img src="spacer.gif" width="72" height="1" border="0"></td>
    <td><img src="spacer.gif" width="11" height="1" border="0"></td>
    <td><img src="spacer.gif" width="72" height="1" border="0"></td>
    <td><img src="spacer.gif" width="9" height="1" border="0"></td>
    <td><img src="spacer.gif" width="71" height="1" border="0"></td>
    <td><img src="spacer.gif" width="10" height="1" border="0"></td>
    <td><img src="spacer.gif" width="71" height="1" border="0"></td>
    <td><img src="spacer.gif" width="20" height="1" border="0"></td>
    <td><img src="spacer.gif" width="1" height="1" border="0"></td>
  </tr>
  <tr> 
    <td colspan="10"><img name="Untitled2_r1_c1" src="Untitled-2_r1_c1.gif" width="755" height="62" border="0"></td>
    <td><img src="spacer.gif" width="1" height="62" border="0"></td>
  </tr>
  <tr> 
    <td colspan="2"><img name="Untitled2_r2_c1" src="Untitled-2_r2_c1.gif" width="419" height="19" border="0"></td>
    <td><a href="#" onMouseOut="FW_startTimeout();"  onMouseOver="window.FW_showMenu(window.fw_menu_0,379,90);" ><img name="Untitled2_r2_c3" src="Untitled-2_r2_c3.gif" width="72" height="19" border="0"></a></td>
    <td><img name="Untitled2_r2_c4" src="Untitled-2_r2_c4.gif" width="11" height="19" border="0"></td>
    <td><a href="#" onMouseOut="FW_startTimeout();"  onMouseOver="window.FW_showMenu(window.fw_menu_1,472,91);" ><img name="Untitled2_r2_c5" src="Untitled-2_r2_c5.gif" width="72" height="19" border="0"></a></td>
    <td><img name="Untitled2_r2_c6" src="Untitled-2_r2_c6.gif" width="9" height="19" border="0"></td>
    <td><a href="#" onMouseOut="FW_startTimeout();"  onMouseOver="window.FW_showMenu(window.fw_menu_2,574,91);" ><img name="Untitled2_r2_c7" src="Untitled-2_r2_c7.gif" width="71" height="19" border="0"></a></td>
    <td><img name="Untitled2_r2_c8" src="Untitled-2_r2_c8.gif" width="10" height="19" border="0"></td>
    <td><a href="#" onMouseOut="FW_startTimeout();"  onMouseOver="window.FW_showMenu(window.fw_menu_3,639,91);" ><img name="Untitled2_r2_c9" src="Untitled-2_r2_c9.gif" width="71" height="19" border="0"></a></td>
    <td><img name="Untitled2_r2_c10" src="Untitled-2_r2_c10.gif" width="20" height="19" border="0"></td>
    <td><img src="spacer.gif" width="1" height="19" border="0"></td>
  </tr>
  <tr> 
    <td bgcolor="#FF9933" height="16" align="left" valign="top">&nbsp;</td>
    <td rowspan="2" colspan="9" align="left" valign="top"> 
      <table width="100%" border="0" cellspacing="6" cellpadding="0">
        <tr> 
          <td height="2" valign="top" align="left" bgcolor="#0066CC" class="small"><img src="imgs/dots.gif" width="33" height="32" align="absmiddle"><font size="4" color="#FFFFFF"><b>请选择预定义文件</b></font></td>
        </tr>
        <tr> 
          <td class="small" valign="top" height="473"> 
            <table width="92%" border="0" align="center">
              <% '目标:Frame.asp, 参数：FullUserName,UserId, ProfileName, profileid
Dim dcnDB
Dim rsQuery
Dim UserName  '传递来的用户名,在数据表Customers中实际上是cust_strid字段
Dim Password  '密码
Dim Msg '如果注册不成功，要显示的消息
Dim FullUserName '用来保存用户完整的名称
Dim UserId '传给Frame.asp，当用户重新选择预定义文件时可以直接引用

UserName =Request.form("uid")
Password =Request.form("pwd")
'if UserName="" then
'   UserName="yahoo"
'   Password="passyahoo"
'End if


'On Error Resume Next
set dcnDB=  Server.CreateObject("ADODB.Connection")
'Session("strConn")="Provider=sqloledb;UID=dragon;PWD=*7EdY#;database=test"
Session("strConn")="Provider=sqloledb;UID=sa;PWD=;database=test;server=dragonchen"
strCnn = Session("strConn")
dcnDB.Open  strCnn
dcnDB.CommandTimeout=100

sql="insert into userlog2(user_strid,userip,visitdate)  values('"& UserName &"','"&_
      		Request.ServerVariables("REMOTE_ADDR")&"',getdate())"

      	dcnDB.Execute(sql)

set rsQuery=Server.CreateObject("ADODB.Recordset")

''--------------检查用户名是否存在，以及密码是否正确-------------------
sql="select c.cust_id,c.cust_name,c.password from customers c where c.cust_strid = '" & UserName & "'"
rsQuery.Open sql,dcnDB,1,1
	Msg=""
	If rsQuery.Bof And rsQuery.Eof then
		Msg="用户名:<font color='#cc0000'>" & UserName & "</font> 不存在!"
	Else
		FullUserName=rsQuery("cust_name")
		UserId      =rsQuery("cust_id")
		If Not rsQuery("password")=Password then
			Msg="用户名与密码不符,请确认输入了正确的密码!"
		End if
	End if
	If Msg <> "" then
		Response.Write("<TR><TD>" & Msg & "</TD></TR>")
		response.Write("<TR><TD align=right><SPAN style='font-size=9pt'><a href='javascript:history.back()'>返回...</a>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></TD></TR>")
		Response.Write("</Table>")
		rsQuery.Close
		set rsQuery=Nothing


		dcnDB.Close
		set dcnDB=Nothing

		Session("strConn")=""

		Response.End
	End if
	Dim custrealname,custrealid
	custrealname=rsQuery(1)
	custrealid=rsQuery(0)
rsQuery.Close
		response.cookies("rep_cust")("name")=FullUserName ' 用户名称
		response.cookies("rep_cust")("id")=UserId ' 客户编号

		Response.cookies("visit")="dragon"  ' 标记用户登录
		
		'response.write FullUserName & "<HR>"
		'response.write UserId & "<HR>"
		'response.write request.cookies("rep_cust")("name") & "<BR>----1"
		'response.write request.cookies("rep_cust")("id") & "<BR>----2"
''---------------------记录用户登陆的日志文件
sql="insert into userlog(user_strid,userip,visitdate)  values('"& FullUserName &"','"&_
      		Request.ServerVariables("REMOTE_ADDR")&"',getdate())"

      	dcnDB.Execute(sql)

		''---------------------记录用户登陆的日志文件

''----------------------到这里用户已经成功注册-------------------------

Dim AProfiles() '保存对应于该用户的所有profile_id和profile_Name
Dim ProfileCount 'profile的数目

sql="select * from profile Where cust_id = " & UserId
rsQuery.Open sql,dcnDB,1,1
If rsQuery.Bof And rsQuery.Eof then
	ProfileCount=0
Else
	ProfileCount=rsQuery.RecordCount
End if

Redim AProfiles(ProfileCount - 1,1)
if ProfileCount > 0 then
	for i=0 to ProfileCount - 1
		AProfiles(i,0)=rsQuery("profile_id")
		AProfiles(i,1)=rsQuery("profile_name")

		rsQuery.MoveNext
	next
end if

%>
              <tr> 
                <td> 
                  <form method="post" action="index.asp" name="frmProfile">
<!--                   <form method="post" action="/newreport/index.asp" name="frmProfile"> -->
                    <table width="100%" border="0">
                      <tr bgcolor="#330066"> 
                        <td bgcolor="#FFFFFF">&nbsp;</td>
                      </tr>
                      <%If ProfileCount > 0 then

        	     Response.Write("<tr bgcolor='#CCCC99'><td>")
                Response.write("<input type='radio' name='profile' value='" & AProfiles(0,0) & "_" & AProfiles(0,1)  & "'checked>" & AProfiles(0,1))
                Response.Write("<input type='hidden' name='profile" & AProfiles(0,0) & "' value=" & AProfiles(0,1)&">")
                response.write("</td></tr>")
        	    For i=1 to ProfileCount - 1
        		response.write("<tr bgcolor='#cccc99'><td>")
        		Response.Write("<input type='radio' name='profile' value='" & AProfiles(i,0) & "_" & AProfiles(i,1) & "'>" & AProfiles(i,1))
        		Response.Write("<input type='hidden' name='profile" & AProfiles(i,0) & "' value=" & AProfiles(i,1))
        		Response.Write("</td></tr>")

        	Next

          Else
        	Response.Write("<tr bgcolor='#CCCC99'><td>没有预定义文件可以显示!</td></tr>")
        	Response.End
          End if
          %>
                    </table>
                    <p>&nbsp; </p>
                    <table width="100%" border="0">
                      <tr> 
                        <td width="18%">
                          <input type="hidden" name="fullname" value="<%=FullUserName%>">
                          <input type="hidden" name="userid" value="<%=UserId%>">
                        </td>
                        <td width="32%"> 
                          <div align="center"><a href="javascript:document.frmProfile.submit()"> 
                            <img src="imgs/sure.gif" width="61" height="23"></a></div>
                        </td>
                        <td width="18%"></td>
                      </tr>
                    </table>
                  </form>
                </td>
              </tr>
            </table>
            <table width="50%" border="0" cellspacing="1" cellpadding="2" align="center">
              <tr>
                <td align="center">
				<!-- 加入applet判断 -->
<SCRIPT Language="JavaScript" src="inc/checkbrowser.js">
</SCRIPT>
<SCRIPT Language="JavaScript">
//
// This page assumes that the location of the Installable
// JAR and CAB is in a sibling directory called classes
//
function checkForBrowser()
{
	if(is.nav4up && is.minor >= 4.06)
	{
		downloadNow();
	}
}

function downloadNow ()
{
	installed_version = netscape.softupdate.Trigger.GetVersionInfo("java/download/visualmining/netcharts");
	vi = new netscape.softupdate.VersionInfo(3, 6, 0, 0);
	if(installed_version != null && vi.compareTo(installed_version)==0)
	{
		alert("The Java Component classes are already installed.");
	}
	if (navigator.javaEnabled())
	{
		trigger = netscape.softupdate.Trigger;
		if (trigger.UpdateEnabled())
		{
			//must create a fully qualified URL
			var href = document.location.href;
			var loc = href.substring(0, href.substring(0,href.lastIndexOf("/")).lastIndexOf("/")+1)+"classes/install.jar";
			trigger.ConditionalSoftwareUpdate( loc, "java/download/visualmining/netcharts", vi, trigger.DEFAULT_MODE);
		}
		else
		{
			alert("Enable SmartUpdate before running this script.");
		}
	}
	else
	{
		alert("Enable Java before running this script.");
	}
}
</SCRIPT>
<script Language="JavaScript">
checkForBrowser();
if(is.ie4up)
{
	document.writeln("<span style='font-size:9pt'><center>注：软件只能在IE下浏览</center><br><div align=left><ul><li>新增了数据表格功能，您可以方便的在图表和数据表之间自由切换。<li>新增了图表的多种时间查询条件。<li>功能更为强大，图表数目达到百余种。<li>监测数据更为精确，您可以轻松掌握自己网站的一举一动。<li>新增了报警日志功能。<li>自定义起始时间功能，使您方便的查看各时段的网站性能表现。<li>新增加了帮助系统，使您更加得心应手的使用。</ul><div></span><p>");
	document.writeln('<applet code="netcharts.apps.NFBarchartApp" codebase="../classes" width="300" height="100">');
	document.writeln("<param name='NFParamScript' value='");
	document.writeln('Header = ("",black,"宋体");');
	document.writeln('HeaderBox = (white);');
	document.writeln('Background = (white);');
	document.writeln("'>");
	document.writeln('<param name="useslibrary" value="NetCharts">');
	document.writeln('<param name="useslibrarycodebase" value="../classes/install.cab">');
	document.writeln('<param name="useslibraryversion" value="3,6,0,0">');
	document.writeln('</applet>');

}
else if(is.nav4up && is.minor >= 4.06)
{
	document.writeln("Starting Installation...<p>");
	document.writeln("Please answer <b>'Grant'</b> to all questions asked.<p>");
	document.writeln("You will be prompted to restart Communicator when the installation is complete.");
}
else
{
	document.writeln("需要Netscape 4.06或Internet Explorer 4.0以上版本.");
}
</script>
				<!-- 加入applet判断 -->
				</td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
    <td height="16"><img src="spacer.gif" width="1" height="40" border="0"></td>
  </tr>
  <tr> 
    <td bgcolor="#0066aa" height="464" align="left" valign="top" class="small"> 
      <p><br>
        <br>
        <b><font color="#FFFFFF" size="3">预定义文件</font></b></p>
      <p><font color="#FFFFFF">预定义文件是由客户根据自己的业<br>
        </font></p>
      <p><font color="#FFFFFF"> 务需要自行设置的。您可以自由定</font></p>
      <p><font color="#FFFFFF">义需要监测的网页、需要监测的业</font></p>
      <p><font color="#FFFFFF">务流程和进行监测的城市。对于绝</font></p>
      <p><font color="#FFFFFF">大多数客户而言，需要的预定义文</font></p>
      <p><font color="#FFFFFF">件可能要多于一个。</font></p>
      <p>&nbsp;</p>
      </td>
    <td height="464"><img src="spacer.gif" width="1" height="299" border="0"></td>
  </tr>
</table>
</body>
</html>
<%
set rsQuery=Nothing
dcnDB.Close
set dcnDB=Nothing
%>